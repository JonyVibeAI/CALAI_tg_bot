# üîß –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –¥–ª—è Timeweb

## ‚ùå –ü—Ä–æ–±–ª–µ–º—ã, –∫–æ—Ç–æ—Ä—ã–µ –±—ã–ª–∏:

1. **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –Ω–µ —Å–æ–∑–¥–∞–≤–∞–ª–∞—Å—å**: `FATAL: database "calai" does not exist`
2. **Prisma –Ω–µ —Ä–∞–±–æ—Ç–∞–ª –≤ Alpine**: –û—à–∏–±–∫–∏ —Å `libssl.so.1.1`
3. **–ú–∏–≥—Ä–∞—Ü–∏–∏ –Ω–µ –ø—Ä–∏–º–µ–Ω—è–ª–∏—Å—å**: –ë–î –±—ã–ª–∞ –ø—É—Å—Ç–∞—è

## ‚úÖ –ß—Ç–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ:

### 1. Dockerfile
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω `openssl` –∏ `openssl-dev` –≤ Alpine –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω `ca-certificates` –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω—ã—Ö —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π
- ‚úÖ –°–æ–∑–¥–∞–Ω `docker-entrypoint.sh` –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö –º–∏–≥—Ä–∞—Ü–∏–π

### 2. docker-entrypoint.sh
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏–º–µ–Ω—è–µ—Ç –º–∏–≥—Ä–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ `prisma migrate deploy`
- ‚úÖ –°–æ–∑–¥–∞—ë—Ç —Ç–∞–±–ª–∏—Ü—ã –ø–µ—Ä–µ–¥ —Å—Ç–∞—Ä—Ç–æ–º –±–æ—Ç–∞

### 3. docker-compose.yml
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω `?schema=public` –≤ DATABASE_URL
- ‚úÖ –£–≤–µ–ª–∏—á–µ–Ω `start_period` –¥–æ 60 —Å–µ–∫—É–Ω–¥ (–¥–ª—è –º–∏–≥—Ä–∞—Ü–∏–π)
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω healthcheck –¥–ª—è –±–æ—Ç–∞

---

## üöÄ –ù–æ–≤—ã–π –¥–µ–ø–ª–æ–π:

### 1. Push –∏–∑–º–µ–Ω–µ–Ω–∏–π:
```bash
git add .
git commit -m "fix: –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –ø—Ä–æ–±–ª–µ–º—ã —Å Prisma –≤ Alpine –∏ –º–∏–≥—Ä–∞—Ü–∏—è–º–∏"
git push origin main
```

### 2. Redeploy –Ω–∞ Timeweb:

–ü–æ—Å–ª–µ –ø—É—à–∞ Timeweb –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ—Å–æ–±–µ—Ä—ë—Ç –ø—Ä–æ–µ–∫—Ç. –ï—Å–ª–∏ –Ω–µ—Ç ‚Äî —Å–¥–µ–ª–∞–π –≤—Ä—É—á–Ω—É—é:

1. –ó–∞–π–¥–∏ –≤ **Timeweb –ø–∞–Ω–µ–ª—å**
2. –û—Ç–∫—Ä–æ–π –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
3. –ù–∞–∂–º–∏ **"Redeploy"** –∏–ª–∏ **"Restart"**

### 3. –ü—Ä–æ–≤–µ—Ä—å –ª–æ–≥–∏:

–î–æ–ª–∂–Ω–æ –±—ã—Ç—å:
```
üîÑ –ó–∞–ø—É—Å–∫ –º–∏–≥—Ä–∞—Ü–∏–π Prisma...
‚úÖ –ú–∏–≥—Ä–∞—Ü–∏–∏ –ø—Ä–∏–º–µ–Ω–µ–Ω—ã
‚úì –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –ø–æ–¥–∫–ª—é—á–µ–Ω–∞
‚úì Health server –Ω–∞ –ø–æ—Ä—Ç—É 4000
‚úì –ë–æ—Ç –∑–∞–ø—É—â–µ–Ω
```

–ù–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å:
- ‚ùå `FATAL: database "calai" does not exist`
- ‚ùå `Error loading shared library libssl.so.1.1`
- ‚ùå `PrismaClientInitializationError`

---

## üß™ –õ–æ–∫–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞:

```bash
# –£–¥–∞–ª–∏ —Å—Ç–∞—Ä—ã–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –∏ –æ–±—Ä–∞–∑—ã
docker-compose down -v
docker system prune -a -f

# –ü–µ—Ä–µ—Å–æ–±–µ—Ä–∏ –∏ –∑–∞–ø—É—Å—Ç–∏
docker-compose up --build

# –î–æ–ª–∂–Ω–æ —Ä–∞–±–æ—Ç–∞—Ç—å –±–µ–∑ –æ—à–∏–±–æ–∫!
```

---

## üìä –ß—Ç–æ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å:

### Dockerfile (–¥–æ):
```dockerfile
FROM node:18-alpine
# –ù–µ—Ç openssl ‚Üí Prisma –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç
```

### Dockerfile (–ø–æ—Å–ª–µ):
```dockerfile
FROM node:18-alpine
RUN apk add --no-cache openssl openssl-dev ca-certificates
# –¢–µ–ø–µ—Ä—å Prisma —Ä–∞–±–æ—Ç–∞–µ—Ç!
```

### –ù–æ–≤—ã–π —Ñ–∞–π–ª: docker-entrypoint.sh
```bash
#!/bin/sh
npx prisma migrate deploy  # –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞—ë—Ç –ë–î
exec "$@"  # –ó–∞–ø—É—Å–∫–∞–µ—Ç –±–æ—Ç–∞
```

---

## ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã:

1. **–õ–æ–≥–∏ –±–µ–∑ –æ—à–∏–±–æ–∫**
2. **–ë–æ—Ç –æ—Ç–≤–µ—á–∞–µ—Ç –≤ Telegram**
3. **Health endpoint —Ä–∞–±–æ—Ç–∞–µ—Ç**: `{"status":"ok"}`
4. **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö —Å–æ–∑–¥–∞–Ω–∞ –∏ –∑–∞–ø–æ–ª–Ω–µ–Ω–∞**

–¢–µ–ø–µ—Ä—å –≤—Å—ë –¥–æ–ª–∂–Ω–æ —Ä–∞–±–æ—Ç–∞—Ç—å! üéâ
